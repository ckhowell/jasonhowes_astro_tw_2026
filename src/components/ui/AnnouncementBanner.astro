---
// AnnouncementBanner - Oatmeal-style full-width announcement bar
// Typically placed at the very top of the page, above the nav

interface Props {
  text: string;
  linkText?: string;
  linkHref?: string;
  dismissable?: boolean;
  variant?: 'default' | 'accent' | 'dark';
}

const {
  text,
  linkText,
  linkHref,
  dismissable = false,
  variant = 'default'
} = Astro.props;

const variantClasses = {
  default: 'bg-brand-100 dark:bg-brand-800 text-brand-700 dark:text-brand-300',
  accent: 'bg-accent-500 dark:bg-accent-600 text-white',
  dark: 'bg-brand-900 dark:bg-brand-950 text-white'
};
---

<div
  class={`relative py-3 px-4 text-sm text-center ${variantClasses[variant]}`}
  data-announcement-banner
>
  <div class="max-w-7xl mx-auto flex items-center justify-center gap-2">
    <span>{text}</span>
    {linkText && linkHref && (
      <a
        href={linkHref}
        class="inline-flex items-center gap-1 font-medium underline underline-offset-4 hover:no-underline"
      >
        {linkText}
        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </a>
    )}
  </div>

  {dismissable && (
    <button
      type="button"
      class="absolute right-4 top-1/2 -translate-y-1/2 p-1 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors"
      aria-label="Dismiss announcement"
      data-dismiss-banner
    >
      <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  )}
</div>

{dismissable && (
  <script>
    const banner = document.querySelector('[data-announcement-banner]');
    const dismissBtn = document.querySelector('[data-dismiss-banner]');

    if (banner && dismissBtn) {
      dismissBtn.addEventListener('click', () => {
        banner.remove();
      });
    }
  </script>
)}
